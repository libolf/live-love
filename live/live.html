<!DOCTYPE html>
<html lang="zh-CN">
    <head>
        <meta charset="UTF-8">
        <title>Hi-Fi ç²¾è‡´é»‘èƒ¶å”±æœº</title>
        <style>
            :root {
                --wood: #2c1e1a;
                --metal: #a0a0a0;
                --vinyl: #0a0a0a;
                --label: #d32f2f;
            }

            html, body {
                height: 100vh;
                margin: 0;
                overflow: hidden;
            }

            body {
                display: flex;
                flex-direction: column;
                justify-content: center;
                align-items: center;
                background: #1a1a1a;
                position: relative;
                font-family: 'Arial', sans-serif;
            }

            #notes-container {
                position: fixed;
                top: 0;
                left: 0;
                width: 100%;
                height: 100%;
                pointer-events: none;
                z-index: 1;
            }

            .note {
                position: absolute;
                font-size: 24px;
                opacity: 0;
                user-select: none;
                animation: float ease-in forwards;
                z-index: 1;
                text-shadow: 0 0 8px rgba(255, 255, 255, 0.8);
            }

            /* ğŸ”¥ æ ¸å¿ƒä¼˜åŒ–1ï¼šè°ƒæ•´åŠ¨ç”»èµ·ç‚¹/é€æ˜åº¦ï¼Œè®©éŸ³ç¬¦å¿«é€Ÿæ˜¾ç¤ºï¼Œç¼©çŸ­è§†è§‰å»¶è¿Ÿ */
            @keyframes float {
                0% {
                    /* åˆå§‹ä½ç½®ä»å±å¹•åº•éƒ¨æ”¹ä¸ºå¯è§†åŒºä¸­ä¸‹éƒ¨ï¼Œç‚¹å‡»å³è§ */
                    transform: translateY(70vh) translateX(0) rotate(0deg);
                    opacity: 0; /* åˆå§‹é€æ˜ï¼Œå¿«é€Ÿæ·¡å…¥ */
                }
                5% {
                    opacity: 1; /* å‰5%åŠ¨ç”»å¿«é€Ÿæ·¡å…¥ï¼Œç¬é—´æ˜¾ç¤º */
                    transform: translateY(65vh) translateX(0) rotate(0deg);
                }
                85% {
                    opacity: 1; /* ä¿æŒé«˜é€æ˜åº¦åˆ°85%ï¼Œä¹…ç•™å±å¹• */
                }
                100% {
                    transform: translateY(-200px) translateX(var(--offset)) rotate(var(--rotate));
                    opacity: 0;
                }
            }

            .content-wrapper {
                display: flex;
                justify-content: center;
                align-items: center;
                width: 100%;
                flex: 1;
                position: relative;
                padding: 20px 0;
            }
            .turntable {
                position: relative;
                width: 480px;
                height: 360px;
                background: linear-gradient(145deg, #3d2b26, #211512);
                border-radius: 8px;
                box-shadow:
                        0 30px 80px rgba(0,0,0,0.7),
                        inset 0 2px 2px rgba(255,255,255,0.1);
                padding: 18px;
                border-bottom: 10px solid #140d0b;
                z-index: 10;
            }
            .platter-base {
                position: absolute;
                top: 50%;
                left: 45%;
                transform: translate(-50%, -50%);
                width: 310px;
                height: 310px;
                background: #111;
                border-radius: 50%;
                border: 3px solid #333;
                box-shadow: 0 8px 25px rgba(0,0,0,0.5);
            }
            .record-container {
                position: absolute;
                top: 5px;
                left: 5px;
                width: 300px;
                height: 300px;
                border-radius: 50%;
                overflow: hidden;
                transition: transform 1.5s cubic-bezier(0.4, 0, 0.2, 1);
            }
            .vinyl {
                width: 100%;
                height: 100%;
                background:
                        radial-gradient(circle at center, transparent 35%, rgba(255,255,255,0.05) 40%, transparent 45%),
                        repeating-radial-gradient(#181818 0px, #111 1px, #181818 2px);
                border-radius: 50%;
                display: flex;
                justify-content: center;
                align-items: center;
                position: relative;
            }
            .vinyl::after {
                content: "";
                position: absolute;
                width: 100%;
                height: 100%;
                background: conic-gradient(
                        from 0deg,
                        transparent 0%,
                        rgba(255,255,255,0.15) 10%,
                        transparent 20%,
                        transparent 45%,
                        rgba(255,255,255,0.1) 50%,
                        transparent 60%,
                        transparent 100%
                );
                border-radius: 50%;
                opacity: 0.7;
                animation: gloss-rotate 8s linear infinite;
                pointer-events: none;
            }
            @keyframes gloss-rotate {
                0% { transform: rotate(0deg); }
                100% { transform: rotate(360deg); }
            }
            .label {
                position: absolute;
                width: 100px;
                height: 100px;
                background: var(--label);
                border-radius: 50%;
                border: 4px solid #000;
                display: flex;
                justify-content: center;
                align-items: center;
                z-index: 5;
                box-shadow: inset 0 0 8px rgba(0,0,0,0.5);
                font-weight: bold;
                color: white;
                font-size: 9px;
                text-align: center;
                line-height: 1.2;
            }
            .label::before {
                content: "HI-FI\nMUSIC";
                white-space: pre;
            }
            .label::after {
                content: "";
                width: 10px;
                height: 10px;
                background: #ccc;
                border-radius: 50%;
                box-shadow: 0 0 4px rgba(0,0,0,0.8);
                position: absolute;
            }
            .tonearm-assembly {
                position: absolute;
                top: 35px;
                right: 55px;
                width: 90px;
                height: 90px;
                z-index: 20;
            }
            .pivot {
                width: 70px;
                height: 70px;
                background: radial-gradient(circle at 30% 30%, #ecf0f1, #7f8c8d);
                border-radius: 50%;
                box-shadow: 0 6px 12px rgba(0,0,0,0.4);
                display: flex;
                justify-content: center;
                align-items: center;
                position: relative;
                z-index: 25;
            }
            .pivot::after {
                content: "";
                position: absolute;
                width: 18px;
                height: 18px;
                background: #333;
                border-radius: 50%;
                border: 2px solid #666;
                box-shadow: 0 0 4px rgba(0,0,0,0.7);
            }
            .arm-pole {
                position: absolute;
                top: 35px;
                left: 35px;
                width: 11px;
                height: 230px;
                transform-origin: top center;
                transform: rotate(-15deg);
                transition: transform 1.2s cubic-bezier(0.45, 0.05, 0.55, 0.95);
                z-index: 22;
            }
            .arm-pole::before {
                content: "";
                position: absolute;
                width: 100%;
                height: 100%;
                background: linear-gradient(to right, #95a5a6, #eee, #95a5a6);
                border-radius: 5px;
                clip-path: polygon(0 0, 100% 0, 100% 70%, 40% 85%, 40% 100%, 0 100%);
                box-shadow: 0 2px 4px rgba(0,0,0,0.3);
            }
            .cartridge {
                position: absolute;
                bottom: -4px;
                left: -13px;
                width: 28px;
                height: 50px;
                background: #222;
                border-radius: 3px;
                transform: rotate(20deg);
                box-shadow: 4px 4px 8px rgba(0,0,0,0.3);
                z-index: 23;
            }
            .cartridge::before {
                content: "";
                position: absolute;
                right: -9px;
                top: 9px;
                width: 14px;
                height: 2.5px;
                background: #777;
            }
            .cartridge::after {
                content: "";
                position: absolute;
                bottom: -7px;
                left: 7px;
                width: 13px;
                height: 13px;
                background: #cc9966;
                border-radius: 50%;
                border: 2px solid #886633;
                box-shadow: 0 0 4px rgba(0,0,0,0.5);
            }
            .playing .record-container {
                animation: spin 1.8s linear infinite;
                animation-delay: 1s;
            }
            .playing .arm-pole {
                transform: rotate(24deg);
            }
            @keyframes spin {
                from { transform: rotate(0deg); }
                to { transform: rotate(360deg); }
            }
            .power-btn {
                position: absolute;
                bottom: 25px;
                left: 25px;
                width: 55px;
                height: 55px;
                background: radial-gradient(circle at center, #444, #222);
                border: 2px solid #555;
                border-radius: 50%;
                color: #888;
                font-size: 9px;
                font-weight: bold;
                cursor: pointer;
                box-shadow: 0 3px 0 #000, 0 6px 15px rgba(0,0,0,0.5);
                transition: all 0.2s;
                z-index: 15;
            }
            .power-btn:active {
                transform: translateY(2px);
                box-shadow: 0 1px 0 #000;
            }
            .playing .power-btn {
                color: #00ff00;
                text-shadow: 0 0 5px rgba(0,255,0,0.5);
                border-color: #00aa00;
                box-shadow: 0 3px 0 #006600, 0 6px 15px rgba(0,255,0,0.3);
            }
            .power-btn:hover {
                box-shadow: 0 3px 0 #000, 0 6px 20px rgba(255,255,255,0.4);
            }
            .knob {
                position: absolute;
                bottom: 30px;
                right: 165px;
                width: 36px;
                height: 36px;
                background: radial-gradient(circle at 30% 30%, #999, #444);
                border-radius: 50%;
                border: 1px solid #222;
                box-shadow: 0 2px 0 #222, inset 0 -2px 4px rgba(0,0,0,0.5);
                z-index: 15;
            }
            .knob::after {
                content: "";
                position: absolute;
                top: 7px;
                left: 7px;
                width: 5px;
                height: 5px;
                background: #cc3333;
                border-radius: 50%;
                box-shadow: 0 0 2px rgba(255,0,0,0.8);
            }
            .custom-footer {
                text-align: center;
                padding: 24px 20px 18px;
                position: relative;
                width: 100%;
                background: transparent;
                z-index: 20;
            }
            .custom-footer::before {
                content: "";
                position: absolute;
                top: 0;
                left: 50%;
                transform: translateX(-50%);
                width: 85%;
                height: 1px;
                background: linear-gradient(90deg,
                transparent,
                rgba(255,255,255,0.12),
                rgba(255,255,255,0.2),
                rgba(255,255,255,0.12),
                transparent);
                box-shadow: 0 1px 0 rgba(0,0,0,0.85) inset;
            }
            .footer-text {
                font-family: -apple-system, BlinkMacSystemFont, "Segoe UI", Roboto, sans-serif;
                font-size: 13px;
                font-weight: 400;
                margin-bottom: 20px;
                letter-spacing: 1.8px;
                text-transform: uppercase;
                line-height: 1.2;
                display: inline-block;
                color: rgba(255, 255, 255, 0.3);
                background: linear-gradient(
                        to right,
                        rgba(255, 255, 255, 0.3) 0%,
                        rgba(255, 255, 255, 0.3) 40%,
                        #fff 50%,
                        rgba(255, 255, 255, 0.3) 60%,
                        rgba(255, 255, 255, 0.3) 100%
                );
                background-size: 200% auto;
                -webkit-background-clip: text;
                -webkit-text-fill-color: transparent;
                animation: shimmer 3s linear infinite;
            }
            @keyframes shimmer {
                0% { background-position: 200% center; }
                100% { background-position: -200% center; }
            }
            .badge-group {
                display: flex;
                justify-content: center;
                gap: 16px;
                flex-wrap: wrap;
                max-width: 650px;
                margin: 0 auto;
                padding: 0 8px;
            }
            .badge-group a {
                transition: all 0.3s cubic-bezier(0.25, 0.8, 0.25, 1);
                text-decoration: none;
                line-height: 0;
                display: inline-block;
                opacity: 0.95;
            }
            .badge-group a:hover {
                transform: translateY(-3px) scale(1.025);
                opacity: 1;
                filter: brightness(1.12) drop-shadow(0 4px 8px rgba(0,0,0,0.22));
            }
            .badge-group img {
                height: 34px;
                width: auto;
                border-radius: 4px;
            }
            @media (max-height: 720px) {
                .turntable {
                    width: 440px;
                    height: 330px;
                }
                .platter-base { width: 285px; height: 285px; }
                .record-container { width: 275px; height: 275px; }
                .label { width: 90px; height: 90px; font-size: 8px; }
                .tonearm-assembly { top: 32px; right: 50px; }
                .arm-pole { height: 210px; }
                .cartridge { width: 26px; height: 46px; }
                .power-btn { width: 50px; height: 50px; font-size: 8px; }
                .knob { width: 34px; height: 34px; }
            }
            @media (max-height: 650px) {
                .turntable {
                    width: 410px;
                    height: 300px;
                    padding: 15px;
                }
                .platter-base { width: 265px; height: 265px; }
                .record-container { width: 255px; height: 255px; }
                .label { width: 85px; height: 85px; }
                .tonearm-assembly { top: 30px; right: 45px; }
                .arm-pole { height: 195px; }
                .custom-footer { padding: 18px 16px 14px; }
                .footer-text { font-size: 12px; margin-bottom: 16px; }
                .badge-group img { height: 30px; }
            }
        </style>
    </head>
    <body>
        <div id="notes-container"></div>
        <div class="content-wrapper">
            <div class="turntable" id="mainPlayer">
                <div class="platter-base">
                    <div class="record-container">
                        <div class="vinyl">
                            <div class="label"></div>
                        </div>
                    </div>
                </div>
                <div class="tonearm-assembly">
                    <div class="pivot"></div>
                    <div class="arm-pole" id="tonearm">
                        <div class="cartridge"></div>
                    </div>
                </div>
                <button class="power-btn" id="startStop">START<br>STOP</button>
                <div class="knob"></div>
            </div>
            <audio id="bgm" loop>
                <!-- <source src="pigeon_swan.mp3?no-idm" type="audio/mpeg"> -->
                <!-- æ‚¨çš„æµè§ˆå™¨ä¸æ”¯æŒéŸ³é¢‘æ’­æ”¾ã€‚ -->
            </audio>
        </div>
        <footer class="custom-footer">
            <div class="footer-text">Â© 2026 Crafted with Passion</div>
            <div class="badge-group">
                <a href="https://github.com/libolf/live-love" target="_blank" rel="noopener">
                    <img src="https://img.shields.io/badge/Powered%20by-GitHub-181717?style=for-the-badge&logo=github&logoColor=white" alt="GitHub">
                </a>
                <a href="https://vercel.com" target="_blank" rel="noopener">
                    <img src="https://img.shields.io/badge/Vercel-000000?style=for-the-badge&logo=vercel&logoColor=white" alt="Vercel">
                </a>
                <a href="https://supabase.com" target="_blank" rel="noopener">
                    <img src="https://img.shields.io/badge/Supabase-3ECF8E?style=for-the-badge&logo=supabase&logoColor=white" alt="Supabase">
                </a>
            </div>
        </footer>

        <script>
            // é¡µé¢åŠ è½½åè‡ªåŠ¨è°ƒç”¨ API è®°å½•
            fetch("/api/log").catch(err => console.log("Log skipped"));

            document.addEventListener('DOMContentLoaded', () => {
                const player = document.getElementById('mainPlayer');
                const btn = document.getElementById('startStop');
                const notesContainer = document.getElementById('notes-container');
                const bgm = document.getElementById('bgm');

                const notes = ['â™ª', 'â™«', 'â™¬', 'â™©', 'â™­', 'â™®', 'â™¯'];
                let noteInterval = null;
                let isPlaying = false;

                function createNote() {
                    const note = document.createElement('div');
                    note.className = 'note';
                    note.textContent = notes[Math.floor(Math.random() * notes.length)];

                    const startX = Math.random() * window.innerWidth;
                    const offsetX = (Math.random() - 0.5) * 450;
                    const rotate = (Math.random() - 0.5) * 360;
                    const size = 14 + Math.random() * 24;
                    const hue = 200 + Math.random() * 160;
                    const saturation = 70 + Math.random() * 30;
                    const lightness = 70 + Math.random() * 15;
                    const duration = 12 + Math.random() * 8;

                    // ğŸ”¥ æ ¸å¿ƒä¼˜åŒ–2ï¼šéšæœºè®¾ç½®åˆå§‹topå€¼ï¼ˆå¯è§†åŒº30%-80%ï¼‰ï¼ŒéŸ³ç¬¦ç›´æ¥å‡ºç°åœ¨å±å¹•é‡Œ
                    const randomTop = 30 + Math.random() * 50;
                    note.style.left = `${startX}px`;
                    note.style.top = `${randomTop}vh`; // æ›¿æ¢bottomä¸ºtopï¼ŒåŸºäºå¯è§†åŒºé«˜åº¦å®šä½
                    note.style.fontSize = `${size}px`;
                    note.style.color = `hsl(${hue}, ${saturation}%, ${lightness}%)`;
                    note.style.setProperty('--offset', `${offsetX}px`);
                    note.style.setProperty('--rotate', `${rotate}deg`);
                    note.style.animationDuration = `${duration}s`;

                    notesContainer.appendChild(note);

                    setTimeout(() => {
                        if (note.parentNode) note.remove();
                    }, duration * 1000);
                }

                btn.addEventListener('click', () => {
                    player.classList.toggle('playing');
                    isPlaying = !isPlaying;

                    if (isPlaying) {
                        // ğŸ”¥ æ— å»¶è¿Ÿæ‰¹é‡åˆ›å»º35ä¸ªéŸ³ç¬¦ï¼Œç‚¹å‡»å³é“ºæ»¡å±å¹•
                        for (let i = 0; i < 12; i++) {
                            createNote();
                        }
                        // æ— ç¼è¡”æ¥æŒç»­ç”Ÿæˆï¼Œ0å»¶è¿Ÿå¯åŠ¨ï¼Œå½»åº•æ¶ˆé™¤æ–­æ¡£
                        noteInterval = setInterval(createNote, 1000);

                        setTimeout(() => {
                            if(isPlaying) bgm.play();
                        }, 200);

                        // ç‚¹å‡»æ’­æ”¾æ—¶æ‰åŠ¨æ€è®¾ç½®éŸ³é¢‘srcï¼ŒIDMæ— æ³•æå‰å—…æ¢
//                        bgm.src = 'pigeon_swan.mp3';
//                        bgm.type = 'audio/mpeg';
//                        // åŠ è½½å®Œæˆåè‡ªåŠ¨æ’­æ”¾
//                        bgm.oncanplaythrough = () => {
//                            bgm.play().catch(err => console.log('æ’­æ”¾å¤±è´¥ï¼š', err));
//                        };
//                        // ä¸»åŠ¨è§¦å‘åŠ è½½
//                        bgm.load();
                        loadAudioToMemory('pigeon_swan.mp3');
                    } else {
                        if (noteInterval) {
                            clearInterval(noteInterval);
                            noteInterval = null;
                        }
                        bgm.pause()
                    }
                });

                // åˆå§‹èƒŒæ™¯éŸ³ç¬¦ï¼šä¿ç•™æ·¡å…¥æ•ˆæœï¼Œåˆ†å¸ƒæ›´å‡åŒ€
//                for (let i = 0; i < 6; i++) {
//                    setTimeout(createNote, i * 200);
//                }
//
//                // éæ’­æ”¾çŠ¶æ€åŸºç¡€éŸ³ç¬¦ï¼šç¨æé«˜å¯†åº¦ï¼ŒèƒŒæ™¯æ›´ä¸æ»‘
//                setInterval(() => {
//                    if (!isPlaying) createNote();
//                }, 1200);
            });

            // å°è£…ä¸€ä¸ªå‡½æ•°ï¼Œå°†æ–‡ä»¶è½¬ä¸ºå†…å­˜ Blob é“¾æ¥
            async function loadAudioToMemory(url) {
                try {
                    const response = await fetch(url);
                    const blob = await response.blob();
                    const blobUrl = URL.createObjectURL(blob);
                    bgm.src = blobUrl; // å°†å†…å­˜åœ°å€èµ‹ç»™æ’­æ”¾å™¨
                    console.log("éŸ³é¢‘å·²å®‰å…¨åŠ è½½è‡³å†…å­˜ï¼ŒIDM æ— æ³•æ‹¦æˆª");
                } catch (e) {
                    console.error("åŠ è½½å¤±è´¥ï¼Œè¯·æ£€æŸ¥è·¯å¾„æ˜¯å¦æ­£ç¡®", e);
                }
            }
        </script>
    </body>
</html>
